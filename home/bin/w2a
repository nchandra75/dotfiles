#!/bin/bash
SRC="$HOME/work/"
DST="$HOME/archive/"
echo "Syncing $SRC to $DST"

rsync -a --delete $SRC $DST
RET=$?

if [ $RET -eq 0 ]; then 
	echo "Finished RSYNC.  Now for backup."
else
	echo "Something went wrong with the RSYNC.  Check before continuing."
	exit 1
fi

# Continue on to BUP
bup index -uv $DST
RET=$?
[ $RET -ne 0 ] && echo "Failed BUP" && exit
bup save -n archive $DST
RET=$?
[ $RET -eq 0 ] && echo "Saved BUP!"
[ $RET -ne 0 ] && echo "What happened???"
